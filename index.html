<script src="svg.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.topath.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.parser.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.import.js" type="text/javascript" charset="utf-8"></script>
<script src="jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="ramda.js" type="text/javascript" charset="utf-8"></script>
<div id='indonesia' style='width: 100%; height: 500px;'></div>
<script>
  var s = {}
  var map  = SVG('indonesia');

  function dropLayers(s){
    s.get("layer5").remove();
    s.get("layer2").remove();
    s.get("layer4").remove();
    s.get("layer6").remove();
    s.get("layer1").remove();
    s.get("layer8").remove();
    return s;
  }

  function getParts(s, name, upper){
    return R.reduce(function(list, n){
      var part = s.get(name + '-' + n);
      return part ? list.concat([part]) : list;
    }, [], R.range(1, (upper || 10) + 1));
  }

  function getRegions(regions){
    return function(s){
      return R.reduce(function(dict, name){
        dict[name] = getParts(s, name);
        return dict;
      }, {}, regions);
    }
  }

  function getOcean(s){
    return getParts(s, "ocean", 20);
  }

  var svg = $.ajax({url: 'indonesia.svg', dataType: 'text'}).then(function(text){
    return map.svg(text);
  });


  function mount(name){
    return function(value){
      s[name] = value;
    }
  }

  svg.then(mount("svg"));
  //svg.then(dropLayers);
  svg.then(getRegions(["aceh","sumatera-utara","rian", "sumatera-barat", "sumatera-selatan", "benakulu", "lampung", "jawa-barat", "java-tengah", "musa-tenggara-barat", "musa-tenggara-timur", "maluku", "papua", "sulawesi-utara", "sulawesi-tengah", "sulawesi-tenggara", "sulawesi-salatan", "kalimatan-salatan", "kalimatan-tengah", "kalimatan-barat", "kalimatan-timur", "sarawak"])).then(mount('regions'));
  svg.then(getOcean).then(mount("ocean"));

</script>
