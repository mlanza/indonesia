<script src="svg.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.topath.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.parser.js" type="text/javascript" charset="utf-8"></script>
<script src="svg.import.js" type="text/javascript" charset="utf-8"></script>
<script src="jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="ramda.js" type="text/javascript" charset="utf-8"></script>
<div id='indonesia' style='width: 2650px; height: 1280px;'></div>
<script>
  var s = {}
  var map  = SVG('indonesia');

  function getParts(s, name, upper){
    return R.reduce(function(list, n){
      var part = s.get(name + '-' + n);
      return part ? list.concat([part]) : list;
    }, [], R.range(1, (upper || 10) + 1));
  }

  function getRegions(regions){
    return function(s){
      return R.reduce(function(dict, name){
        dict[name] = getParts(s, name);
        return dict;
      }, {}, regions);
    }
  }

  function getOcean(s){
    return getParts(s, "ocean", 22);
  }

  var svg = $.ajax({url: 'indonesia.svg', dataType: 'text'}).then(function(text){
    return map.svg(text);
  });


  function mount(name){
    return function(value){
      s[name] = value;
    }
  }

  function doto(fn){
    return function (){
      return this.each ? this.each(fn) : fn.call(this);
    }
  }

  function addHover(color, items){
    return R.forEach(function(item){
      item.on('mouseover', doto(function(){
      var fill = this.style('fill');
      this.data('fill', fill);
      this.style({fill: color});
    })).on('mouseout', doto(function(){
      this.style({fill: this.data('fill')});
    }));
    }, items);
  }

  svg.then(mount("svg"));
  svg.then(getRegions(["aceh","sumatera-utara","rian", "sumatera-barat", "sumatera-selatan", "java-temur", "halmahera", "benakulu", "lampung", "bali", "jambi", "jawa-barat", "java-tengah", "musa-tenggara-barat", "musa-tenggara-timur", "maluku", "papua", "sulawesi-utara", "sulawesi-tengah", "sulawesi-tenggara", "sulawesi-salatan", "kalimatan-salatan", "kalimatan-tengah", "kalimatan-barat", "kalimatan-timur", "sarawak"])).then(mount('regions')).then(function(){
    addHover('brown', R.flatten(R.values(s.regions)));
  });
  svg.then(getOcean).then(mount("ocean")).then(function(){
    R.forEach(function(item){
      item.style({fill: 'lightblue'});
    }, s.ocean);
  }).then(function(){
    addHover('blue', s.ocean);
  });

</script>
